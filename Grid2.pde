// TODO: reflect x-axis
color[] colors = { // length = 782
  color(255, 51, 0), 
  color(255, 56, 0), 
  color(255, 69, 0), 
  color(255, 71, 0), 
  color(255, 82, 0), 
  color(255, 83, 0), 
  color(255, 93, 0), 
  color(255, 93, 0), 
  color(255, 102, 0), 
  color(255, 101, 0), 
  color(255, 111, 0), 
  color(255, 109, 0), 
  color(255, 118, 0), 
  color(255, 115, 0), 
  color(255, 124, 0), 
  color(255, 121, 0), 
  color(255, 130, 0), 
  color(255, 126, 0), 
  color(255, 135, 0), 
  color(255, 131, 0), 
  color(255, 141, 11), 
  color(255, 137, 18), 
  color(255, 146, 29), 
  color(255, 142, 33), 
  color(255, 152, 41), 
  color(255, 147, 44), 
  color(255, 157, 51), 
  color(255, 152, 54), 
  color(255, 162, 60), 
  color(255, 157, 63), 
  color(255, 166, 69), 
  color(255, 161, 72), 
  color(255, 170, 77), 
  color(255, 165, 79), 
  color(255, 174, 84), 
  color(255, 169, 87), 
  color(255, 178, 91), 
  color(255, 173, 94), 
  color(255, 182, 98), 
  color(255, 177, 101), 
  color(255, 185, 105), 
  color(255, 180, 107), 
  color(255, 189, 111), 
  color(255, 184, 114), 
  color(255, 192, 118), 
  color(255, 187, 120), 
  color(255, 195, 124), 
  color(255, 190, 126), 
  color(255, 198, 130), 
  color(255, 193, 132), 
  color(255, 201, 135), 
  color(255, 196, 137), 
  color(255, 203, 141), 
  color(255, 199, 143), 
  color(255, 206, 146), 
  color(255, 201, 148), 
  color(255, 208, 151), 
  color(255, 204, 153), 
  color(255, 211, 156), 
  color(255, 206, 159), 
  color(255, 213, 161), 
  color(255, 209, 163), 
  color(255, 215, 166), 
  color(255, 211, 168), 
  color(255, 217, 171), 
  color(255, 213, 173), 
  color(255, 219, 175), 
  color(255, 215, 177), 
  color(255, 221, 180), 
  color(255, 217, 182), 
  color(255, 223, 184), 
  color(255, 219, 186), 
  color(255, 225, 188), 
  color(255, 221, 190), 
  color(255, 226, 192), 
  color(255, 223, 194), 
  color(255, 228, 196), 
  color(255, 225, 198), 
  color(255, 229, 200), 
  color(255, 227, 202), 
  color(255, 231, 204), 
  color(255, 228, 206), 
  color(255, 232, 208), 
  color(255, 230, 210), 
  color(255, 234, 211), 
  color(255, 232, 213), 
  color(255, 235, 215), 
  color(255, 233, 217), 
  color(255, 237, 218), 
  color(255, 235, 220), 
  color(255, 238, 222), 
  color(255, 236, 224), 
  color(255, 239, 225), 
  color(255, 238, 227), 
  color(255, 240, 228), 
  color(255, 239, 230), 
  color(255, 241, 231), 
  color(255, 240, 233), 
  color(255, 243, 234), 
  color(255, 242, 236), 
  color(255, 244, 237), 
  color(255, 243, 239), 
  color(255, 245, 240), 
  color(255, 244, 242), 
  color(255, 246, 243), 
  color(255, 245, 245), 
  color(255, 247, 245), 
  color(255, 246, 248), 
  color(255, 248, 248), 
  color(255, 248, 251), 
  color(255, 249, 251), 
  color(255, 249, 253), 
  color(255, 249, 253), 
  color(254, 249, 255), 
  color(254, 250, 255), 
  color(252, 247, 255), 
  color(252, 248, 255), 
  color(249, 246, 255), 
  color(250, 247, 255), 
  color(247, 245, 255), 
  color(247, 245, 255), 
  color(245, 243, 255), 
  color(245, 244, 255), 
  color(243, 242, 255), 
  color(243, 243, 255), 
  color(240, 241, 255), 
  color(241, 241, 255), 
  color(239, 240, 255), 
  color(239, 240, 255), 
  color(237, 239, 255), 
  color(238, 239, 255), 
  color(235, 238, 255), 
  color(236, 238, 255), 
  color(233, 237, 255), 
  color(234, 237, 255), 
  color(231, 236, 255), 
  color(233, 236, 255), 
  color(230, 235, 255), 
  color(231, 234, 255), 
  color(228, 234, 255), 
  color(229, 233, 255), 
  color(227, 233, 255), 
  color(228, 233, 255), 
  color(225, 232, 255), 
  color(227, 232, 255), 
  color(224, 231, 255), 
  color(225, 231, 255), 
  color(222, 230, 255), 
  color(224, 230, 255), 
  color(221, 230, 255), 
  color(223, 229, 255), 
  color(220, 229, 255), 
  color(221, 228, 255), 
  color(218, 228, 255), 
  color(220, 227, 255), 
  color(217, 227, 255), 
  color(219, 226, 255), 
  color(216, 227, 255), 
  color(218, 226, 255), 
  color(215, 226, 255), 
  color(217, 225, 255), 
  color(214, 225, 255), 
  color(216, 224, 255), 
  color(212, 225, 255), 
  color(215, 223, 255), 
  color(211, 224, 255), 
  color(214, 223, 255), 
  color(210, 223, 255), 
  color(213, 222, 255), 
  color(209, 223, 255), 
  color(212, 221, 255), 
  color(208, 222, 255), 
  color(211, 221, 255), 
  color(207, 221, 255), 
  color(210, 220, 255), 
  color(207, 221, 255), 
  color(209, 220, 255), 
  color(206, 220, 255), 
  color(208, 219, 255), 
  color(205, 220, 255), 
  color(207, 218, 255), 
  color(204, 219, 255), 
  color(207, 218, 255), 
  color(203, 219, 255), 
  color(206, 217, 255), 
  color(202, 218, 255), 
  color(205, 217, 255), 
  color(201, 218, 255), 
  color(204, 216, 255), 
  color(201, 217, 255), 
  color(204, 216, 255), 
  color(200, 217, 255), 
  color(203, 215, 255), 
  color(199, 216, 255), 
  color(202, 215, 255), 
  color(199, 216, 255), 
  color(202, 214, 255), 
  color(198, 216, 255), 
  color(201, 214, 255), 
  color(197, 215, 255), 
  color(200, 213, 255), 
  color(196, 215, 255), 
  color(200, 213, 255), 
  color(196, 214, 255), 
  color(199, 212, 255), 
  color(195, 214, 255), 
  color(198, 212, 255), 
  color(195, 214, 255), 
  color(198, 212, 255), 
  color(194, 213, 255), 
  color(197, 211, 255), 
  color(193, 213, 255), 
  color(197, 211, 255), 
  color(193, 212, 255), 
  color(196, 210, 255), 
  color(192, 212, 255), 
  color(196, 210, 255), 
  color(192, 212, 255), 
  color(195, 210, 255), 
  color(191, 211, 255), 
  color(195, 209, 255), 
  color(191, 211, 255), 
  color(194, 209, 255), 
  color(190, 211, 255), 
  color(194, 208, 255), 
  color(190, 210, 255), 
  color(193, 208, 255), 
  color(189, 210, 255), 
  color(193, 208, 255), 
  color(189, 210, 255), 
  color(192, 207, 255), 
  color(188, 210, 255), 
  color(192, 207, 255), 
  color(188, 209, 255), 
  color(191, 207, 255), 
  color(187, 209, 255), 
  color(191, 206, 255), 
  color(187, 209, 255), 
  color(190, 206, 255), 
  color(186, 208, 255), 
  color(190, 206, 255), 
  color(186, 208, 255), 
  color(190, 206, 255), 
  color(185, 208, 255), 
  color(189, 205, 255), 
  color(185, 208, 255), 
  color(189, 205, 255), 
  color(185, 207, 255), 
  color(188, 205, 255), 
  color(184, 207, 255), 
  color(188, 204, 255), 
  color(184, 207, 255), 
  color(188, 204, 255), 
  color(183, 207, 255), 
  color(187, 204, 255), 
  color(183, 206, 255), 
  color(187, 204, 255), 
  color(183, 206, 255), 
  color(187, 203, 255), 
  color(182, 206, 255), 
  color(186, 203, 255), 
  color(182, 206, 255), 
  color(186, 203, 255), 
  color(182, 205, 255), 
  color(186, 203, 255), 
  color(181, 205, 255), 
  color(185, 202, 255), 
  color(181, 205, 255), 
  color(185, 202, 255), 
  color(181, 205, 255), 
  color(185, 202, 255), 
  color(180, 205, 255), 
  color(184, 202, 255), 
  color(180, 204, 255), 
  color(184, 201, 255), 
  color(180, 204, 255), 
  color(184, 201, 255), 
  color(179, 204, 255), 
  color(184, 201, 255), 
  color(179, 204, 255), 
  color(183, 201, 255), 
  color(179, 204, 255), 
  color(183, 201, 255), 
  color(178, 203, 255), 
  color(183, 200, 255), 
  color(178, 203, 255), 
  color(182, 200, 255), 
  color(178, 203, 255), 
  color(182, 200, 255), 
  color(178, 203, 255), 
  color(182, 200, 255), 
  color(177, 203, 255), 
  color(182, 200, 255), 
  color(177, 202, 255), 
  color(181, 199, 255), 
  color(177, 202, 255), 
  color(181, 199, 255), 
  color(177, 202, 255), 
  color(181, 199, 255), 
  color(176, 202, 255), 
  color(181, 199, 255), 
  color(176, 202, 255), 
  color(180, 199, 255), 
  color(176, 202, 255), 
  color(180, 198, 255), 
  color(175, 201, 255), 
  color(180, 198, 255), 
  color(175, 201, 255), 
  color(180, 198, 255), 
  color(175, 201, 255), 
  color(179, 198, 255), 
  color(175, 201, 255), 
  color(179, 198, 255), 
  color(175, 201, 255), 
  color(179, 198, 255), 
  color(174, 201, 255), 
  color(179, 197, 255), 
  color(174, 201, 255), 
  color(179, 197, 255), 
  color(174, 200, 255), 
  color(178, 197, 255), 
  color(174, 200, 255), 
  color(178, 197, 255), 
  color(173, 200, 255), 
  color(178, 197, 255), 
  color(173, 200, 255), 
  color(178, 197, 255), 
  color(173, 200, 255), 
  color(178, 196, 255), 
  color(173, 200, 255), 
  color(177, 196, 255), 
  color(173, 200, 255), 
  color(177, 196, 255), 
  color(172, 199, 255), 
  color(177, 196, 255), 
  color(172, 199, 255), 
  color(177, 196, 255), 
  color(172, 199, 255), 
  color(177, 196, 255), 
  color(172, 199, 255), 
  color(176, 196, 255), 
  color(172, 199, 255), 
  color(176, 195, 255), 
  color(171, 199, 255), 
  color(176, 195, 255), 
  color(171, 199, 255), 
  color(176, 195, 255), 
  color(171, 199, 255), 
  color(176, 195, 255), 
  color(171, 198, 255), 
  color(176, 195, 255), 
  color(171, 198, 255), 
  color(175, 195, 255), 
  color(170, 198, 255), 
  color(175, 195, 255), 
  color(170, 198, 255), 
  color(175, 194, 255), 
  color(170, 198, 255), 
  color(175, 194, 255), 
  color(170, 198, 255), 
  color(175, 194, 255), 
  color(170, 198, 255), 
  color(175, 194, 255), 
  color(170, 198, 255), 
  color(174, 194, 255), 
  color(169, 198, 255), 
  color(174, 194, 255), 
  color(169, 197, 255), 
  color(174, 194, 255), 
  color(169, 197, 255), 
  color(174, 194, 255), 
  color(169, 197, 255), 
  color(174, 194, 255), 
  color(169, 197, 255), 
  color(174, 193, 255), 
  color(169, 197, 255), 
  color(174, 193, 255), 
  color(169, 197, 255), 
  color(173, 193, 255), 
  color(168, 197, 255), 
  color(173, 193, 255), 
  color(168, 197, 255), 
  color(173, 193, 255), 
  color(168, 197, 255), 
  color(173, 193, 255), 
  color(168, 197, 255), 
  color(173, 193, 255), 
  color(168, 196, 255), 
  color(173, 193, 255), 
  color(168, 196, 255), 
  color(173, 193, 255), 
  color(168, 196, 255), 
  color(173, 192, 255), 
  color(167, 196, 255), 
  color(172, 192, 255), 
  color(167, 196, 255), 
  color(172, 192, 255), 
  color(167, 196, 255), 
  color(172, 192, 255), 
  color(167, 196, 255), 
  color(172, 192, 255), 
  color(167, 196, 255), 
  color(172, 192, 255), 
  color(167, 196, 255), 
  color(172, 192, 255), 
  color(167, 196, 255), 
  color(172, 192, 255), 
  color(166, 196, 255), 
  color(172, 192, 255), 
  color(166, 195, 255), 
  color(171, 192, 255), 
  color(166, 195, 255), 
  color(171, 192, 255), 
  color(166, 195, 255), 
  color(171, 191, 255), 
  color(166, 195, 255), 
  color(171, 191, 255), 
  color(166, 195, 255), 
  color(171, 191, 255), 
  color(166, 195, 255), 
  color(171, 191, 255), 
  color(166, 195, 255), 
  color(171, 191, 255), 
  color(165, 195, 255), 
  color(171, 191, 255), 
  color(165, 195, 255), 
  color(171, 191, 255), 
  color(165, 195, 255), 
  color(170, 191, 255), 
  color(165, 195, 255), 
  color(170, 191, 255), 
  color(165, 195, 255), 
  color(170, 191, 255), 
  color(165, 195, 255), 
  color(170, 191, 255), 
  color(165, 194, 255), 
  color(170, 190, 255), 
  color(165, 194, 255), 
  color(170, 190, 255), 
  color(165, 194, 255), 
  color(170, 190, 255), 
  color(164, 194, 255), 
  color(170, 190, 255), 
  color(164, 194, 255), 
  color(170, 190, 255), 
  color(164, 194, 255), 
  color(170, 190, 255), 
  color(164, 194, 255), 
  color(169, 190, 255), 
  color(164, 194, 255), 
  color(169, 190, 255), 
  color(164, 194, 255), 
  color(169, 190, 255), 
  color(164, 194, 255), 
  color(169, 190, 255), 
  color(164, 194, 255), 
  color(169, 190, 255), 
  color(164, 194, 255), 
  color(169, 190, 255), 
  color(164, 194, 255), 
  color(169, 190, 255), 
  color(163, 194, 255), 
  color(169, 190, 255), 
  color(163, 194, 255), 
  color(169, 189, 255), 
  color(163, 193, 255), 
  color(169, 189, 255), 
  color(163, 193, 255), 
  color(169, 189, 255), 
  color(163, 193, 255), 
  color(168, 189, 255), 
  color(163, 193, 255), 
  color(168, 189, 255), 
  color(163, 193, 255), 
  color(168, 189, 255), 
  color(163, 193, 255), 
  color(168, 189, 255), 
  color(163, 193, 255), 
  color(168, 189, 255), 
  color(163, 193, 255), 
  color(168, 189, 255), 
  color(163, 193, 255), 
  color(168, 189, 255), 
  color(162, 193, 255), 
  color(168, 189, 255), 
  color(162, 193, 255), 
  color(168, 189, 255), 
  color(162, 193, 255), 
  color(168, 189, 255), 
  color(162, 193, 255), 
  color(168, 189, 255), 
  color(162, 193, 255), 
  color(168, 189, 255), 
  color(162, 193, 255), 
  color(167, 188, 255), 
  color(162, 193, 255), 
  color(167, 188, 255), 
  color(162, 193, 255), 
  color(167, 188, 255), 
  color(162, 192, 255), 
  color(167, 188, 255), 
  color(162, 192, 255), 
  color(167, 188, 255), 
  color(162, 192, 255), 
  color(167, 188, 255), 
  color(162, 192, 255), 
  color(167, 188, 255), 
  color(162, 192, 255), 
  color(167, 188, 255), 
  color(161, 192, 255), 
  color(167, 188, 255), 
  color(161, 192, 255), 
  color(167, 188, 255), 
  color(161, 192, 255), 
  color(167, 188, 255), 
  color(161, 192, 255), 
  color(167, 188, 255), 
  color(161, 192, 255), 
  color(167, 188, 255), 
  color(161, 192, 255), 
  color(167, 188, 255), 
  color(161, 192, 255), 
  color(166, 188, 255), 
  color(161, 192, 255), 
  color(166, 188, 255), 
  color(161, 192, 255), 
  color(166, 188, 255), 
  color(161, 192, 255), 
  color(166, 187, 255), 
  color(161, 192, 255), 
  color(166, 187, 255), 
  color(161, 192, 255), 
  color(166, 187, 255), 
  color(161, 192, 255), 
  color(166, 187, 255), 
  color(161, 192, 255), 
  color(166, 187, 255), 
  color(160, 192, 255), 
  color(166, 187, 255), 
  color(160, 192, 255), 
  color(166, 187, 255), 
  color(160, 191, 255), 
  color(166, 187, 255), 
  color(160, 191, 255), 
  color(166, 187, 255), 
  color(160, 191, 255), 
  color(166, 187, 255), 
  color(160, 191, 255), 
  color(166, 187, 255), 
  color(160, 191, 255), 
  color(166, 187, 255), 
  color(160, 191, 255), 
  color(166, 187, 255), 
  color(160, 191, 255), 
  color(165, 187, 255), 
  color(160, 191, 255), 
  color(165, 187, 255), 
  color(160, 191, 255), 
  color(165, 187, 255), 
  color(160, 191, 255), 
  color(165, 187, 255), 
  color(160, 191, 255), 
  color(165, 187, 255), 
  color(160, 191, 255), 
  color(165, 187, 255), 
  color(160, 191, 255), 
  color(165, 187, 255), 
  color(159, 191, 255), 
  color(165, 187, 255), 
  color(159, 191, 255), 
  color(165, 186, 255), 
  color(159, 191, 255), 
  color(165, 186, 255), 
  color(159, 191, 255), 
  color(165, 186, 255), 
  color(159, 191, 255), 
  color(165, 186, 255), 
  color(159, 191, 255), 
  color(165, 186, 255), 
  color(159, 191, 255), 
  color(165, 186, 255), 
  color(159, 191, 255), 
  color(165, 186, 255), 
  color(159, 191, 255), 
  color(165, 186, 255), 
  color(159, 191, 255), 
  color(165, 186, 255), 
  color(159, 191, 255), 
  color(165, 186, 255), 
  color(159, 190, 255), 
  color(165, 186, 255), 
  color(159, 190, 255), 
  color(164, 186, 255), 
  color(159, 190, 255), 
  color(164, 186, 255), 
  color(159, 190, 255), 
  color(164, 186, 255), 
  color(159, 190, 255), 
  color(164, 186, 255), 
  color(159, 190, 255), 
  color(164, 186, 255), 
  color(159, 190, 255), 
  color(164, 186, 255), 
  color(158, 190, 255), 
  color(164, 186, 255), 
  color(158, 190, 255), 
  color(164, 186, 255), 
  color(158, 190, 255), 
  color(164, 186, 255), 
  color(158, 190, 255), 
  color(164, 186, 255), 
  color(158, 190, 255), 
  color(164, 186, 255), 
  color(158, 190, 255), 
  color(164, 186, 255), 
  color(158, 190, 255), 
  color(164, 186, 255), 
  color(158, 190, 255), 
  color(164, 186, 255), 
  color(158, 190, 255), 
  color(164, 185, 255), 
  color(158, 190, 255), 
  color(164, 185, 255), 
  color(158, 190, 255), 
  color(164, 185, 255), 
  color(158, 190, 255), 
  color(164, 185, 255), 
  color(158, 190, 255), 
  color(164, 185, 255), 
  color(158, 190, 255), 
  color(164, 185, 255), 
  color(158, 190, 255), 
  color(164, 185, 255), 
  color(158, 190, 255), 
  color(163, 185, 255), 
  color(158, 190, 255), 
  color(163, 185, 255), 
  color(158, 190, 255), 
  color(163, 185, 255), 
  color(158, 190, 255), 
  color(163, 185, 255), 
  color(158, 190, 255), 
  color(163, 185, 255), 
  color(158, 190, 255), 
  color(163, 185, 255), 
  color(157, 190, 255), 
  color(163, 185, 255), 
  color(157, 190, 255), 
  color(163, 185, 255), 
  color(157, 189, 255), 
  color(163, 185, 255), 
  color(157, 189, 255), 
  color(163, 185, 255), 
  color(157, 189, 255), 
  color(163, 185, 255), 
  color(157, 189, 255), 
  color(163, 185, 255), 
  color(157, 189, 255), 
  color(163, 185, 255), 
  color(157, 189, 255), 
  color(163, 185, 255), 
  color(157, 189, 255), 
  color(163, 185, 255), 
  color(157, 189, 255), 
  color(163, 185, 255), 
  color(157, 189, 255), 
  color(163, 185, 255), 
  color(157, 189, 255), 
  color(163, 185, 255), 
  color(157, 189, 255), 
  color(163, 185, 255), 
  color(157, 189, 255), 
  color(163, 185, 255), 
  color(157, 189, 255), 
  color(163, 185, 255), 
  color(157, 189, 255), 
  color(163, 185, 255), 
  color(157, 189, 255), 
  color(163, 185, 255), 
  color(157, 189, 255), 
  color(163, 184, 255), 
  color(157, 189, 255), 
  color(163, 184, 255), 
  color(157, 189, 255), 
  color(162, 184, 255), 
  color(157, 189, 255), 
  color(162, 184, 255), 
  color(157, 189, 255), 
  color(162, 184, 255), 
  color(157, 189, 255), 
  color(162, 184, 255), 
  color(157, 189, 255), 
  color(162, 184, 255), 
  color(156, 189, 255), 
  color(162, 184, 255), 
  color(156, 189, 255), 
  color(162, 184, 255), 
  color(156, 189, 255), 
  color(162, 184, 255), 
  color(156, 189, 255), 
  color(162, 184, 255), 
  color(156, 189, 255), 
  color(162, 184, 255), 
  color(156, 189, 255), 
  color(162, 184, 255), 
  color(156, 189, 255), 
  color(162, 184, 255), 
  color(156, 189, 255), 
  color(162, 184, 255), 
  color(156, 189, 255), 
  color(162, 184, 255), 
  color(156, 189, 255), 
  color(162, 184, 255), 
  color(156, 189, 255), 
  color(162, 184, 255), 
  color(156, 189, 255), 
  color(162, 184, 255), 
  color(156, 189, 255), 
  color(162, 184, 255), 
  color(156, 189, 255), 
  color(162, 184, 255), 
  color(156, 189, 255), 
  color(162, 184, 255), 
  color(156, 189, 255), 
  color(162, 184, 255), 
  color(156, 188, 255), 
  color(162, 184, 255), 
  color(156, 188, 255), 
  color(162, 184, 255), 
  color(156, 188, 255), 
  color(162, 184, 255), 
  color(156, 188, 255), 
  color(162, 184, 255), 
  color(156, 188, 255), 
  color(162, 184, 255), 
  color(156, 188, 255), 
  color(162, 184, 255), 
  color(156, 188, 255), 
  color(162, 184, 255), 
  color(156, 188, 255), 
  color(162, 184, 255), 
  color(156, 188, 255), 
  color(162, 184, 255), 
  color(156, 188, 255), 
  color(162, 184, 255), 
  color(156, 188, 255), 
  color(161, 184, 255), 
  color(156, 188, 255), 
  color(161, 184, 255), 
  color(155, 188, 255), 
  color(161, 184, 255), 
  color(155, 188, 255), 
  color(161, 183, 255), 
  color(155, 188, 255), 
  color(161, 183, 255), 
  color(155, 188, 255), 
  color(161, 183, 255), 
  color(155, 188, 255), 
  color(161, 183, 255), 
  color(155, 188, 255), 
  color(161, 183, 255), 
  color(155, 188, 255), 
  color(161, 183, 255), 
  color(155, 188, 255), 
  color(161, 183, 255), 
  color(155, 188, 255), 
  color(161, 183, 255), 
  color(155, 188, 255), 
  color(161, 183, 255), 
  color(155, 188, 255), 
  color(161, 183, 255), 
  color(155, 188, 255), 
  color(161, 183, 255), 
  color(155, 188, 255), 
  color(161, 183, 255), 
  color(155, 188, 255), 
  color(161, 183, 255), 
  color(155, 188, 255), 
  color(161, 183, 255), 
  color(155, 188, 255), 
  color(161, 183, 255), 
  color(155, 188, 255)
};

class Grid2 {
  int side;
  int scale;

  float EPSILON_0 = .00000000000885;// 8.85 x 10^-12 permitivity of free space
  float K = 1/(4.0*PI*EPSILON_0);

  PointCharge2[] sources;
  float[][] E_density;
  color[][] E_densityColor;

  Grid2(int _side, int _scale) {
    side = _side;
    scale = _scale;
    E_density = new float[side][side];
    E_densityColor = new color[side][side];
  }

  // magnitude of electric field vector at each pixel
  // charge at each point is +1
  void calculateElectricFieldDensity() {
    float max = 0.0;
    float min = 0.0;
    boolean set = false;

    for (int i = 0; i < side; i++) {
      for (int j = 0; j < side; j++) {
          float[] target = new float[2];
          target[0] = 0.0; // sum of electric field at point i,j,k in x-axis
          target[1] = 0.0; // sum of electric field at point i,j,k in y-axis

          // sum the electrostatic force at the target point
          for (int s = 0; s < sources.length; s++) {
            // calculate displacement r from q[s]
            float[] r = new float[2]; // target - source
            r[0] = i/scale - sources[s].pos.x/scale;
            r[1] = j/scale - sources[s].pos.y/scale;

            if (r[0] == 0.0 && r[1] == 0.0)
              continue;

            float r_mag = sqrt(r[0]*r[0] + r[1]*r[1]); // r magnitude
            float[] r_unit = new float[2]; // r unit vector
            r_unit[0] = r[0] / r_mag;
            r_unit[1] = r[1] / r_mag;

            target[0] += (sources[s].charge * r_unit[0]) / (r_mag*r_mag);
            target[1] += (sources[s].charge * r_unit[1]) / (r_mag*r_mag);
          }
          E_density[i][j] = sqrt(target[0]*target[0] + target[1]*target[1]); // magnitude of the electric field force superposition

          if (!set) {
            max = E_density[i][j];
            min = E_density[i][j];
            set = true;
          } else {
            if (E_density[i][j] > max)
              max = E_density[i][j];
            if (E_density[i][j] < min)
              min = E_density[i][j];
          }
      }
    }

    colorMode(HSB, 1.0, 1.0, 1.0);
    for (int i = 0; i < side; i++)
      for (int j = 0; j < side; j++) {
         float index = map(E_density[i][j], min, max, 0, 1.0);
          E_densityColor[i][j] = color(index, 1.0, 1.0);
        }
  }

  void drawElectricFieldDensity2D(int z) {
    for(int i = 0; i < side; i++) {
      for(int j = 0; j < side; j++) {
        set(i, j, E_densityColor[i][j]);
      }
    }
  }
}

